name = "wisp-lb"
main = "src/index.ts"
compatibility_date = "2024-12-01"

[vars]
# Comma-separated list of upstream Wisp server WebSocket URLs
# Override in wrangler.toml or via `wrangler secret put UPSTREAMS`
UPSTREAMS = "wss://wisp1.example.com/wisp,wss://wisp2.example.com/wisp"

[[durable_objects.bindings]]
name = "WISP_PROXY"
class_name = "WispProxy"

[[durable_objects.bindings]]
name = "UPSTREAM_REGISTRY"
class_name = "UpstreamRegistry"

[[migrations]]
tag = "v1"
new_classes = ["WispProxy"]

[[migrations]]
tag = "v2"
new_classes = ["UpstreamRegistry"]
